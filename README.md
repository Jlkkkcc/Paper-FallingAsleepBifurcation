# Paper-FallingAsleepBifurcation
 The code and final data repository for paper: "Falling Asleep is a predictable catastrophic bifurcation dynamic".

**Paper DOI**:

**The raw sleep datasets**:

1. Multi-Ethnic Study of Atherosclerosis (MESA); Open-source dataset that can be obtained from National Sleep Research Resources (NSRR); https://sleepdata.org/datasets/mesa 

2. The cohort 2 dataset was collected by authors, and it can be made available under sufficient material transfer agreements (MTA). Please contact the authors.


## Some notices
The code was written and working in MATLAB R2023a version and Python 3.7, with the additional functions/packages all working under this environment and tested in the Ubuntu system. If the code does not work or run on your side, check firstly your software versions (including external software not included here); Contact the authors if you have done every essential check.

Sometimes the external software has been updated so that necessary changes are necessary to make the code running. I have tried to mark them as far as I know, however might not be comprehensive. Contact us if so.

### External Packages required

1. CATCH-22; Please download and install following their instructions [here](https://github.com/DynamicsAndNeuralSystems/catch22).

   **Notes:** This package has been updated from the version we used (27 features) now to 29 features. Excluding the last two features or modify the codes if you want to include the last two features
2. Python package for Functional principal component analysis (FPCA) [here](https://fda.readthedocs.io/en/latest/).

	**Notes:** This package has been updated if you use Python 3.10 and the code given might return errors running Regularised FPCA analysis.

## Basic introduction of this repository









